/**
 * Copyright (C) 2013 Rafael Almeida Erthal Hermano
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see http://www.gnu.org/licenses/.
 */
var Ajax=new Class(function(defaults){var query;defaults=defaults||{};defaults.method=defaults.method||"GET";defaults.url=defaults.url||"/";defaults.data=defaults.data||null;defaults.evaljson=defaults.evaljson||false;defaults.onerror=defaults.onerror||null;defaults.onsuccess=defaults.onsuccess||null;query=function(e,t){var n="",r;t=t||"";if(e){if(e.constructor===Number||e.constructor===String||e.constructor===Boolean||e.constructor===Date){return t+"="+e}else if(e.constructor===Object){for(r in e){if(e.hasOwnProperty(r)){n+=query(e[r],t?t+"["+r+"]":r)+"&"}}return n.slice(0,n.length-1)}else{return t+"="+escape(e)}}else{return""}};this.request=function(url,params){var requester,success,error;success=function(cb){var data;if(cb){if(params.evaljson){data=eval("("+(requester.responseText||{})+")")}else if(defaults.evaljson){data=eval("("+(requester.responseText||{})+")")}cb(requester.responseText)}};error=function(e){if(e){e()}};if(window.XDomainRequest&&url.indexOf("http://")>-1){requester=new XDomainRequest}else if(window.XMLHttpRequest){requester=new XMLHttpRequest}else{requester=new ActiveXObject("Microsoft.XMLHTTP")}if(requester){requester.onreadystatechange=function(){if(requester.readyState===4){if(requester.status!=200&&requester.status!=304){error(params.onerror||defaults.onerror)}else{success(params.onsuccess||defaults.onsuccess)}}};requester.open(params.method||defaults.method,(url||defaults.url)+(params.data||defaults.data?"?"+query(params.data||defaults.data):""),true);requester.setRequestHeader("User-Agent","XMLHTTP/1.0");if(params.data||defaults.data){requester.setRequestHeader("Content-type","application/x-www-form-urlencoded")}requester.send()}};this.get=function(e,t){t=t||{};t.method="GET";this.request(e,t)};this.put=function(e,t){t=t||{};t.method="PUT";this.request(e,t)};this.post=function(e,t){t=t||{};t.method="POST";this.request(e,t)};this.del=function(e,t){t=t||{};t.method="DELETE";this.request(e,t)}})